<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Trader Interativo</title>
<style>
body {
  margin:0;
  font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
}
h1{color:#ffcc00; text-shadow:0 0 15px rgba(255,204,0,0.7); margin-bottom:10px; text-align:center;}

.bet-section{margin-bottom:15px; display:flex; flex-direction:column; align-items:center; width:90%; max-width:400px;}
.bet-section input[type=range]{width:100%;}
.bet-section .bet-value{margin:5px 0; text-align:center;}

#chartContainer{width:320px; height:200px; background:#222; border-radius:15px; margin-bottom:10px; overflow:hidden; box-shadow:0 0 25px rgba(255,204,0,0.4);}
canvas{display:block;}

.multiplier-box{font-size:2.5rem;font-weight:bold;margin-bottom:5px;color:#ffcc00;text-shadow:0 0 15px rgba(255,204,0,0.8);}
.timer{font-size:1.2rem;margin-bottom:15px;color:#ff5555;font-weight:bold;}

.balance-box{
  margin-bottom:15px; font-size:1rem; color:#fff;
  display:flex; justify-content:space-between; width:320px; max-width:90%;
}
#cashoutBtn{
  padding:14px 28px;font-size:1.2rem;font-weight:bold;border:none;border-radius:10px;
  background:#ffcc00;color:#000;cursor:pointer;transition:all 0.3s ease; box-shadow:0 4px 25px rgba(255,204,0,0.7);
  margin-bottom:20px;
  animation: pulse 1.2s infinite;
}
@keyframes pulse{
  0%,100%{box-shadow:0 0 25px rgba(255,204,0,0.5);}
  50%{box-shadow:0 0 50px rgba(255,255,0,0.9);}
}
#cashoutBtn:hover{transform:scale(1.05);}

.modal{
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.85);
  display:flex; align-items:center; justify-content:center;
  opacity:0; visibility:hidden; transition:opacity 0.3s ease;
  z-index:1000;
}
.modal.active{opacity:1; visibility:visible;}
.modal-content{
  background:#2a2a2a; padding:25px; border-radius:15px; max-width:400px; width:90%; text-align:center;
  animation:slideUp 0.4s ease; box-shadow:0 8px 25px rgba(0,0,0,0.6);
}
@keyframes slideUp{from{transform:translateY(50px);opacity:0;}to{transform:translateY(0);opacity:1;}}
.modal-content h2{margin-bottom:15px;color:#ffcc00;}
.modal-content p{margin-bottom:20px; line-height:1.5;}
.modal-content button{
  margin:10px;padding:12px 20px;border:none;border-radius:8px;font-weight:bold;cursor:pointer; transition:0.3s;
}
.registerBtn{background:#ffcc00;color:#000;}
.redeemBtn{background:#444;color:#fff;}
.registerBtn:hover{background:#ffdb4d; transform:scale(1.05);}
.redeemBtn:hover{background:#555; transform:scale(1.05);}

/* Feed jogadores */
.feed{
  margin-top:20px; width:90%; max-width:400px; background:#111; padding:15px; border-radius:12px; max-height:200px; overflow-y:auto;
}
.feed h3{margin-top:0;color:#ffcc00; text-align:center;}
.feed ul{list-style:none;padding:0;margin:0;}
.feed li{padding:5px 0; border-bottom:1px solid #222; font-size:0.95rem;}

/* Partículas */
.particle{
  position:absolute;
  width:6px;
  height:6px;
  background:yellow;
  border-radius:50%;
  pointer-events:none;
  z-index:2000;
  opacity:1;
  animation:explode 1s forwards;
}
@keyframes explode{
  to{transform:translate(var(--x), var(--y)) scale(0); opacity:0;}
}

/* Responsivo */
@media(max-width:480px){
  h1{font-size:1.4rem;}
  .multiplier-box{font-size:2rem;}
  #chartContainer{width:90%; height:150px;}
  .balance-box{width:90%;}
}
</style>
</head>
<body>

<h1>Mini Trader Interativo</h1>

<div class="bet-section">
  <input type="range" id="betInput" min="8" max="100" value="8">
  <div class="bet-value">Valor da aposta: <span id="betDisplay">8</span> MZN</div>
  <button id="startBtn">Iniciar Trader</button>
</div>

<div id="chartContainer">
  <canvas id="chart" width="320" height="200"></canvas>
</div>

<div class="multiplier-box" id="multiplier">1.00x</div>
<div class="timer">Tempo restante: <span id="timer">120</span>s</div>

<div class="balance-box">
  <span>Saldo: <strong id="balance">100</strong> MZN</span>
</div>

<button id="cashoutBtn" disabled>Cashout</button>

<div class="modal" id="modalCashout">
  <div class="modal-content">
    <h2>Parabéns!</h2>
    <p>Ganhaste <span id="winValue">0</span> MZN!</p>
    <button class="registerBtn" id="redeemBtn">Resgatar</button>
  </div>
</div>

<div class="modal" id="modalRegister">
  <div class="modal-content">
    <h2>Registrar-se</h2>
    <p>Para resgatar seu valor, faça seu cadastro e um depósito mínimo de <strong>50 MZN</strong>.</p>
    <button class="registerBtn" id="goToSite">Ir para casa de apostas</button>
  </div>
</div>

<div class="feed">
  <h3>Jogadores online</h3>
  <ul id="playersList">
    <li>João retirou 24 MZN</li>
    <li>Maria retirou 32 MZN</li>
    <li>Carlos retirou 15 MZN</li>
  </ul>
</div>

<script>
const betInput=document.getElementById("betInput");
const betDisplay=document.getElementById("betDisplay");
const multiplierEl=document.getElementById("multiplier");
const timerEl=document.getElementById("timer");
const canvas=document.getElementById("chart");
const ctx=canvas.getContext("2d");
const startBtn=document.getElementById("startBtn");
const cashoutBtn=document.getElementById("cashoutBtn");
const balanceEl=document.getElementById("balance");
const modalCashout=document.getElementById("modalCashout");
const modalRegister=document.getElementById("modalRegister");
const redeemBtn=document.getElementById("redeemBtn");
const goToSite=document.getElementById("goToSite");
const winValueEl=document.getElementById("winValue");
const playersList=document.getElementById("playersList");

let multiplier=1.00;
let running=false;
let timeLeft=120;
let dataPoints=[];
let betValue=8;
let traderLocked=false;

// Atualiza valor do range
betInput.addEventListener("input",()=>{betDisplay.textContent=betInput.value;});

// Chart
function updateChart(){
  if(running){
    multiplier += 0.02 + (Math.random()*0.03 - 0.015);
    if(multiplier<1) multiplier=1;
    multiplierEl.textContent=multiplier.toFixed(2)+"x";
    dataPoints.push(multiplier);
    if(dataPoints.length>canvas.width) dataPoints.shift();
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.beginPath();
    ctx.moveTo(0, canvas.height - dataPoints[0]*20);
    for(let i=1;i<dataPoints.length;i++){
      ctx.lineTo(i, canvas.height - dataPoints[i]*20);
    }
    ctx.strokeStyle=multiplier>multiplierEl.dataset.prev? "#0f0" : "#f00";
    ctx.lineWidth=2.5;
    ctx.shadowColor=ctx.strokeStyle;
    ctx.shadowBlur=10;
    ctx.stroke();
    multiplierEl.dataset.prev = multiplier;
    requestAnimationFrame(updateChart);
  }
}

// Cashout
function doCashout(){
  running=false;
  const win=(betValue*multiplier).toFixed(2);
  balanceEl.textContent=(parseFloat(balanceEl.textContent)+parseFloat(win)).toFixed(2);
  winValueEl.textContent=win;
  modalCashout.classList.add("active");
  createParticles();
  addPlayerEntry(win);
  traderLocked=true; // Bloqueia trader
}

cashoutBtn.addEventListener("click",()=>{doCashout();});

// Redeem
redeemBtn.addEventListener("click",()=>{
  modalCashout.classList.remove("active");
  modalRegister.classList.add("active");
});
goToSite.addEventListener("click",()=>{
  window.location.href="https://go.aff.betvivo.partners/wydkfw29";
});

// Start trader
startBtn.addEventListener("click",()=>{
  if(traderLocked) return;
  betValue=parseFloat(betInput.value);
  multiplier=1.0;
  dataPoints=[];
  running=true;
  cashoutBtn.disabled=false;
  updateChart();
});

// Partículas
function createParticles(){
  for(let i=0;i<50;i++){
    const p=document.createElement("div");
    p.classList.add("particle");
    const x=(Math.random()*200-100)+"px";
    const y=(Math.random()*200-100)+"px";
    p.style.setProperty("--x",x);
    p.style.setProperty("--y",y);
    p.style.left="50%";
    p.style.top="50%";
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1000);
  }
}

// Feed jogadores
function addPlayerEntry(win){
  const li=document.createElement("li");
  const names=["Ana","Bruno","Carla","David","Elisa","Filipe"];
  li.textContent=`${names[Math.floor(Math.random()*names.length)]} retirou ${win} MZN`;
  playersList.prepend(li);
  if(playersList.childNodes.length>10) playersList.removeChild(playersList.lastChild);
}

// Timer (opcional)
setInterval(()=>{
  if(running && timeLeft>0){
    timeLeft--;
    timerEl.textContent=timeLeft;
  }
},1000);
</script>

</body>
</html>
